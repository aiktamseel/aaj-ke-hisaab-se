<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aaj Ke Hisaab Se - PK Inflation Adjusted Calculators</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Calculate inflation-adjusted values for Pakistani Rupee (PKR) with easy-to-use calculators. Convert historical amounts to present value and calculate inflation-adjusted returns.">
    <meta name="keywords" content="inflation, consumer price index, Pakistan inflation, rupee value, inflation adjusted returns, historical value calculator">
    <meta name="author" content="Tamseel Ahmad">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Aaj Ke Hisaab Se - PK Inflation Adjusted Calculators">
    <meta property="og:description" content="Calculate inflation-adjusted values for Pakistani Rupee (PKR) with our easy-to-use calculators.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pkr.tamseel.pk">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Aaj Ke Hisaab Se - PK Inflation Adjusted Calculators">
    <meta name="twitter:description" content="Calculate inflation-adjusted values for Pakistani Rupee (PKR) with easy-to-use calculators.">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://pkr.tamseel.pk">
</head>
<body>
    <h1>Aaj Ke Hisaab Se</h1>
    
    <h2>PKR Historic to Present Value Converter</h2>
    <div>
        Mode: 
        <input type="radio" id="yearly" name="mode" value="yearly" checked>
        <label for="yearly">Yearly</label>
        <input type="radio" id="monthly" name="mode" value="monthly">
        <label for="monthly">Monthly</label>
    </div>
    
    <br>
    
    <div style="display: flex; align-items: center; gap: 20px;">
        <div>
            Rs. <input type="number" id="leftAmount" value="100">
            <br>
            in <select id="leftPeriod"></select>
        </div>
        
        <div>≈</div>
        
        <div>
            Rs. <input type="number" id="rightAmount" value="">
            <br>
            in <select id="rightPeriod"></select>
        </div>
    </div>

    <div id="technicalDetails" style="margin-top: 30px; padding: 15px; border: 1px solid #ccc;">
        <div id="detailsContent">
            <p>Select periods to see calculation details</p>
        </div>
    </div>

    <h2>Inflation Adjusted Returns Calculator</h2>
    <div>
    <div>
        Amount Invested: Rs. <input type="number" id="amountInvested" value="1000">
    </div>
    
    <div>
        Investment Date: <select id="investmentDate"></select>
    </div>
    
    <div>
        End Date: <select id="endDate"></select>
    </div>
    
    <div>
        End Value: Rs. <input type="number" id="endValue" value="100000">
    </div>
    
    <div>
        Income/Dividend (optional): Rs. <input type="number" id="incomeDividend" value="0">
    </div>
    
    <div style="margin-top: 30px; padding: 15px; border: 1px solid #ccc;">
        <strong>Results:</strong>
        <table>
            <tr>
                <td>Annualized Return:</td>
                <td id="annualizedReturn">-</td>
            </tr>
            <tr>
                <td>Inflation Adjusted Annualized Return:</td>
                <td id="inflationAdjustedAnnualized">-</td>
            </tr>
            <tr>
                <td>Absolute Return:</td>
                <td id="absoluteReturn">-</td>
            </tr>
            <tr>
                <td>Inflation Adjusted Absolute Return:</td>
                <td id="inflationAdjustedAbsolute">-</td>
            </tr>
        </table>
    </div>
</div>




    <script>
        let cpiData = null;
        let currentMode = 'yearly';

        // Load CPI data
        fetch('pk-cpi.json')
            .then(response => response.json())
            .then(data => {
                cpiData = data;
                populateDropdowns();
                populateReturnDropdowns();
                calculate('left');
                calculateReturns();
            });

        // Get DOM elements
        const leftAmount = document.getElementById('leftAmount');
        const rightAmount = document.getElementById('rightAmount');
        const leftPeriod = document.getElementById('leftPeriod');
        const rightPeriod = document.getElementById('rightPeriod');
        const yearlyRadio = document.getElementById('yearly');
        const monthlyRadio = document.getElementById('monthly');

        // Mode change listeners
        yearlyRadio.addEventListener('change', () => {
            if (yearlyRadio.checked) {
                currentMode = 'yearly';
                populateDropdowns();
                calculate('left');
            }
        });

        monthlyRadio.addEventListener('change', () => {
            if (monthlyRadio.checked) {
                currentMode = 'monthly';
                populateDropdowns();
                calculate('left');
            }
        });

        // Input listeners
        leftAmount.addEventListener('input', () => calculate('left'));
        leftPeriod.addEventListener('change', () => calculate('left'));
        rightAmount.addEventListener('input', () => calculate('right'));
        rightPeriod.addEventListener('change', () => calculate('right'));

        function populateDropdowns() {
            if (!cpiData) return;

            const periods = Object.keys(cpiData[currentMode]).sort();
            
            // Clear and populate left dropdown
            leftPeriod.innerHTML = '';
            rightPeriod.innerHTML = '';
            
            periods.forEach(period => {
                const option1 = document.createElement('option');
                option1.value = period;
                option1.textContent = period;
                leftPeriod.appendChild(option1);
                
                const option2 = document.createElement('option');
                option2.value = period;
                option2.textContent = period;
                rightPeriod.appendChild(option2);
            });

            // Set default selections
            if (periods.length > 1) {
                leftPeriod.value = periods[0];
                rightPeriod.value = periods[periods.length - 1];
            }
        }

        function calculate(source) {
            if (!cpiData) return;

            const leftCPI = cpiData[currentMode][leftPeriod.value];
            const rightCPI = cpiData[currentMode][rightPeriod.value];

            if (!leftCPI || !rightCPI) return;

            if (source === 'left') {
                const leftValue = parseFloat(leftAmount.value) || 0;
                const rightValue = leftValue * (rightCPI / leftCPI);
                rightAmount.value = rightValue.toFixed(2);
            } else {
                const rightValue = parseFloat(rightAmount.value) || 0;
                const leftValue = rightValue * (leftCPI / rightCPI);
                leftAmount.value = leftValue.toFixed(2);
            }

            updateTechnicalDetails(leftCPI, rightCPI);
        }

        function updateTechnicalDetails(leftCPI, rightCPI) {
            const detailsContent = document.getElementById('detailsContent');
            if (!detailsContent) return;
            
            const baseYear = cpiData.metadata.baseYear;
            const leftPeriodValue = leftPeriod.value;
            const rightPeriodValue = rightPeriod.value;
            
            // Determine which is earlier (t1) and which is later (t2)
            let t1Period, t2Period, t1CPI, t2CPI;
            
            if (currentMode === 'yearly') {
                if (parseInt(leftPeriodValue) <= parseInt(rightPeriodValue)) {
                    t1Period = leftPeriodValue;
                    t2Period = rightPeriodValue;
                    t1CPI = leftCPI;
                    t2CPI = rightCPI;
                } else {
                    t1Period = rightPeriodValue;
                    t2Period = leftPeriodValue;
                    t1CPI = rightCPI;
                    t2CPI = leftCPI;
                }
            } else {
                // For monthly data, compare as dates
                const leftDate = new Date(leftPeriodValue + '-01');
                const rightDate = new Date(rightPeriodValue + '-01');
                
                if (leftDate <= rightDate) {
                    t1Period = leftPeriodValue;
                    t2Period = rightPeriodValue;
                    t1CPI = leftCPI;
                    t2CPI = rightCPI;
                } else {
                    t1Period = rightPeriodValue;
                    t2Period = leftPeriodValue;
                    t1CPI = rightCPI;
                    t2CPI = leftCPI;
                }
            }
            
            const absoluteChange = ((t2CPI - t1CPI) / t1CPI * 100).toFixed(2);
            
            let annualizedChange = 0;
            if (currentMode === 'yearly') {
                const years = parseInt(t2Period) - parseInt(t1Period);
                if (years > 0) {
                    annualizedChange = (Math.pow(t2CPI / t1CPI, 1 / years) - 1) * 100;
                    annualizedChange = annualizedChange.toFixed(2);
                }
            } else {
                // For monthly data, calculate years between periods
                const [year1, month1] = t1Period.split('-').map(Number);
                const [year2, month2] = t2Period.split('-').map(Number);
                const months = (year2 - year1) * 12 + (month2 - month1);
                const years = months / 12;
                if (years > 0) {
                    annualizedChange = (Math.pow(t2CPI / t1CPI, 1 / years) - 1) * 100;
                    annualizedChange = annualizedChange.toFixed(2);
                }
            }

            detailsContent.innerHTML = `
                <p><strong>Base Year:</strong> ${baseYear}</p>
                <p><strong>T1 CPI (${t1Period}):</strong> ${t1CPI}</p>
                <p><strong>T2 CPI (${t2Period}):</strong> ${t2CPI}</p>
                <p><strong>Absolute Percentage Change:</strong> ${absoluteChange}%</p>
                <p><strong>Annualized Percentage Change:</strong> ${annualizedChange}%</p>
                <p><strong>Formula:</strong> Adjusted Amount = Original Amount × (T2 CPI / T1 CPI)</p>
            `;
        }

        // Get return calculator elements
        const amountInvested = document.getElementById('amountInvested');
        const investmentDate = document.getElementById('investmentDate');
        const endDate = document.getElementById('endDate');
        const endValue = document.getElementById('endValue');
        const incomeDividend = document.getElementById('incomeDividend');

        // Add event listeners for return calculator
        amountInvested.addEventListener('input', calculateReturns);
        investmentDate.addEventListener('change', calculateReturns);
        endDate.addEventListener('change', calculateReturns);
        endValue.addEventListener('input', calculateReturns);
        incomeDividend.addEventListener('input', calculateReturns);

        function populateReturnDropdowns() {
            if (!cpiData) return;
            
            const periods = Object.keys(cpiData.monthly).sort();
            
            // Clear and populate dropdowns
            investmentDate.innerHTML = '';
            endDate.innerHTML = '';
            
            periods.forEach(period => {
                const option1 = document.createElement('option');
                option1.value = period;
                option1.textContent = period;
                investmentDate.appendChild(option1);
                
                const option2 = document.createElement('option');
                option2.value = period;
                option2.textContent = period;
                endDate.appendChild(option2);
            });
            
            // Set default selections
            if (periods.length > 1) {
                investmentDate.value = periods[0];
                endDate.value = periods[periods.length - 1];
            }
        }

        function calculateReturns() {
            if (!cpiData) return;
            
            const V0 = parseFloat(amountInvested.value) || 0;
            const VT = parseFloat(endValue.value) || 0;
            const income = parseFloat(incomeDividend.value) || 0;
            
            const startPeriod = investmentDate.value;
            const endPeriod = endDate.value;
            
            const CPI0 = cpiData.monthly[startPeriod];
            const CPIT = cpiData.monthly[endPeriod];
            
            if (!CPI0 || !CPIT || V0 === 0) {
                document.getElementById('absoluteReturn').textContent = '-';
                document.getElementById('inflationAdjustedAbsolute').textContent = '-';
                document.getElementById('annualizedReturn').textContent = '-';
                document.getElementById('inflationAdjustedAnnualized').textContent = '-';
                return;
            }
            
            // Calculate time period in months (inclusive of both ends)
            const [startYear, startMonth] = startPeriod.split('-').map(Number);
            const [endYear, endMonth] = endPeriod.split('-').map(Number);
            const T = (endYear - startYear) * 12 + (endMonth - startMonth) + 1;
            
            // Total final value including income/dividend
            const totalFinalValue = VT + income;
            
            // Absolute Return = VT/V0 - 1
            const absoluteReturn = (totalFinalValue / V0) - 1;
            
            // Annualized Return = (VT/V0)^(12/T) - 1
            const annualizedReturn = T > 0 ? Math.pow(totalFinalValue / V0, 12 / T) - 1 : 0;
            
            // Inflation Adjusted Absolute Return = (VT/V0)/(CPIT/CPI0) - 1
            const inflationAdjustedAbsolute = (totalFinalValue / V0) / (CPIT / CPI0) - 1;
            
            // Inflation Adjusted Annualized Return = ((VT/V0)/(CPIT/CPI0))^(12/T) - 1
            const inflationAdjustedAnnualized = T > 0 ? Math.pow((totalFinalValue / V0) / (CPIT / CPI0), 12 / T) - 1 : 0;
            
            // Display results
            document.getElementById('absoluteReturn').textContent = (absoluteReturn * 100).toFixed(2) + '%';
            document.getElementById('inflationAdjustedAbsolute').textContent = (inflationAdjustedAbsolute * 100).toFixed(2) + '%';
            document.getElementById('annualizedReturn').textContent = (annualizedReturn * 100).toFixed(2) + '%';
            document.getElementById('inflationAdjustedAnnualized').textContent = (inflationAdjustedAnnualized * 100).toFixed(2) + '%';
        }
    </script>
</body>
</html>
